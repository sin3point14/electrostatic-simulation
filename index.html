<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
        #canvas {
            border: 5px black solid;
            position: absolute;
            top: 10px;
            left: 10px;
        }
    </style>
</head>

<body>

    <canvas id="canvas"></canvas>

    <script>
        var arrows = [];
        var pointCharges = [];
        var k = 1000000; //constant for inverse square law
        function drawArrow() {
            ctx.fillStyle = 'red';
            for (a of arrows) {
                console.log(a.positionalX, a.positionalY);
                ctx.translate(a.positionalX, a.positionalY);
                let rot = Math.atan2(a.ey, a.ex);
                ctx.rotate(rot);
                ctx.fillRect(0, -2, 50, 5);
                ctx.beginPath();
                ctx.moveTo(50, 15);
                ctx.lineTo(70, 0);
                ctx.lineTo(50, -15);
                ctx.closePath();
                ctx.fill();
                ctx.rotate(-rot);
                ctx.translate(-a.positionalX, -a.positionalY);
            }
        };
        function Arrow(x, y) {
            this.positionalX = x;
            this.positionalY = y;
            this.ex = 0;
            this.ey = 0;
            console.log(this.positionalX, this.positionalY);
        };
        function PointCharge(x, y, q) {
            this.positionalX = x;
            this.positionalY = y;
            this.charge = q;
        };
        function distance(x1, y1, x2, y2) {
            return Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));
        };
        function calcE() {
            for (a of arrows) {
                for (q of pointCharges) {
                    let d = distance(a.positionalX, a.positionalY, q.positionalX, q.positionalY);
                    a.ex += k * q.charge * (a.positionalX - q.positionalX) / d;
                    a.ey += k * q.charge * (a.positionalY - q.positionalY) / d;
                }
            }
        };
        function initArrow() {
            for (var i = cx - 40; i >= 0; i -= 80) {
                for (var j = cy - 40; j >= 0; j -= 80) {
                    arrows.push(new Arrow(i, j));
                }
            }
            for (var i = cx + 40; i <= 2 * cx; i += 80) {
                for (var j = cy - 40; j >= 0; j -= 80) {
                    arrows.push(new Arrow(i, j));
                }
            }
            for (var i = cx + 40; i <= 2 * cx; i += 80) {
                for (var j = cy + 40; j < 2 * cy; j += 80) {
                    arrows.push(new Arrow(i, j));
                }
            }
            for (var i = cx - 40; i >= 0; i -= 80) {
                for (var j = cy - 40; j < 2 * cy - 0; j += 80) {
                    arrows.push(new Arrow(i, j));
                }
            }
        };
        function drawCharge() {
            for (q of pointCharges) {
                ctx.beginPath();
                ctx.arc(q.positionalX, q.positionalY, 40, 0, 2 * Math.PI);
                ctx.fillStyle = "blue";
                ctx.fill();
                ctx.fillStyle = 'white';
                ctx.fillRect(q.positionalX - 6, q.positionalY - 30, 13, 61);
                ctx.fillRect(q.positionalX - 30, q.positionalY - 6, 61, 13);
            }
        }
        function addPointCharge(x, y, q) {
            pointCharges.push(new PointCharge(x, y, q))
        }
        var canvas = document.getElementById('canvas');
        var ctx = canvas.getContext('2d');
        ctx.canvas.width = window.innerWidth - 40;
        ctx.canvas.height = window.innerHeight - 40;
        var cx = Math.floor(ctx.canvas.width / 2);
        var cy = Math.floor(ctx.canvas.height / 2);
        initArrow();
        for(a of arrows){
            console.log(a);
        }
        addPointCharge(cx - 500, cy, 1);
        addPointCharge(cx + 50, cy-400, 1);
        addPointCharge(cx + 50, cy+400, 1);
        calcE();
        drawCharge();
        drawArrow();
    </script>
</body>

</html>